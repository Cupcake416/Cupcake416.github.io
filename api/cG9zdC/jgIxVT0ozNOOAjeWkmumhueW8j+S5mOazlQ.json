{"title":"「UOJ34」多项式乘法","date":"2018-03-20T13:00:59.000Z","excerpt":"","slug":"「UOJ34」多项式乘法","updated":"2018-07-14T14:59:55.934Z","content":"<h2 id=\"题目大意\"><a href=\"#题目大意\" class=\"headerlink\" title=\"题目大意\"></a>题目大意</h2><p>给你两个多项式，请输出乘起来后的多项式。</p>\n<h2 id=\"解析\"><a href=\"#解析\" class=\"headerlink\" title=\"解析\"></a>解析</h2><p>快速傅里叶变换模板</p>\n<h2 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h2><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> db double</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> <span class=\"built_in\">std</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N=<span class=\"number\">400010</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> db PI=<span class=\"built_in\">acos</span>(<span class=\"number\">-1</span>);</span><br><span class=\"line\"><span class=\"keyword\">int</span> n,m,tot,maxp,rev[N];</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">Com</span>&#123;</span></span><br><span class=\"line\">    db real,image;</span><br><span class=\"line\">    Com <span class=\"keyword\">operator</span>+(<span class=\"keyword\">const</span> Com&amp; k)<span class=\"keyword\">const</span>&#123;<span class=\"keyword\">return</span> (Com)&#123;real+k.real,image+k.image&#125;;&#125;;</span><br><span class=\"line\">    Com <span class=\"keyword\">operator</span>-(<span class=\"keyword\">const</span> Com&amp; k)<span class=\"keyword\">const</span>&#123;<span class=\"keyword\">return</span> (Com)&#123;real-k.real,image-k.image&#125;;&#125;;</span><br><span class=\"line\">    Com <span class=\"keyword\">operator</span>*(<span class=\"keyword\">const</span> Com&amp; k)<span class=\"keyword\">const</span>&#123;<span class=\"keyword\">return</span> (Com)&#123;real*k.real-image*k.image,real*k.image+image*k.real&#125;;&#125;;</span><br><span class=\"line\">    Com <span class=\"keyword\">operator</span>/(<span class=\"keyword\">const</span> <span class=\"keyword\">int</span> k)<span class=\"keyword\">const</span>&#123;<span class=\"keyword\">return</span> (Com)&#123;real/k,image/k&#125;;&#125;;</span><br><span class=\"line\">&#125;a[N],b[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">fft</span><span class=\"params\">(Com* a,<span class=\"keyword\">int</span> b)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i++) <span class=\"keyword\">if</span>(rev[i]&gt;i) swap(a[i],a[rev[i]]);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> len=<span class=\"number\">2</span>;len&lt;=n;len&lt;&lt;=<span class=\"number\">1</span>)&#123;</span><br><span class=\"line\">        Com wn=(Com)&#123;<span class=\"built_in\">cos</span>(<span class=\"number\">2.0</span>*PI/len),<span class=\"built_in\">sin</span>(<span class=\"number\">2.0</span>*PI/len)*b&#125;;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i+=len)&#123;</span><br><span class=\"line\">            Com w=(Com)&#123;<span class=\"number\">1</span>,<span class=\"number\">0</span>&#125;;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j=<span class=\"number\">0</span>;j&lt;(len&gt;&gt;<span class=\"number\">1</span>);j++,w=w*wn)&#123;</span><br><span class=\"line\">                Com x=a[i+j],y=a[i+j+(len&gt;&gt;<span class=\"number\">1</span>)]*w;</span><br><span class=\"line\">                a[i+j]=x+y,a[i+j+(len&gt;&gt;<span class=\"number\">1</span>)]=x-y;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(b==<span class=\"number\">-1</span>) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i++) a[i]=a[i]/n;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d%d\"</span>,&amp;n,&amp;m);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;=n;i++) <span class=\"built_in\">scanf</span>(<span class=\"string\">\"%lf\"</span>,&amp;a[i].real);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;=m;i++) <span class=\"built_in\">scanf</span>(<span class=\"string\">\"%lf\"</span>,&amp;b[i].real);</span><br><span class=\"line\">    tot=n+m,n=<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(n&lt;=tot) n&lt;&lt;=<span class=\"number\">1</span>,maxp++;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;n;i++) rev[i]=(rev[i&gt;&gt;<span class=\"number\">1</span>]&gt;&gt;<span class=\"number\">1</span>)|((i&amp;<span class=\"number\">1</span>)&lt;&lt;(maxp<span class=\"number\">-1</span>));</span><br><span class=\"line\">    fft(a,<span class=\"number\">1</span>);fft(b,<span class=\"number\">1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;n;i++) a[i]=a[i]*b[i];</span><br><span class=\"line\">    fft(a,<span class=\"number\">-1</span>);</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">0</span>;i&lt;=tot;i++) <span class=\"built_in\">printf</span>(<span class=\"string\">\"%d \"</span>,<span class=\"keyword\">int</span>(a[i].real+<span class=\"number\">0.1</span>));</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","next":{"title":"「luogu1782」旅行商的背包","slug":"「luogu1782」旅行商的背包"},"link":"/2018/03/20","toc":[{"title":"题目大意","id":"题目大意","index":"1"},{"title":"解析","id":"解析","index":"2"},{"title":"代码","id":"代码","index":"3"}]}