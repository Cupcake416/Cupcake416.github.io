{"title":"「POJ2947」Widget Factory","date":"2018-03-08T05:27:58.000Z","excerpt":"","slug":"「POJ2947」Widget Factory","updated":"2018-07-17T15:51:44.315Z","content":"<h2 id=\"题目大意\"><a href=\"#题目大意\" class=\"headerlink\" title=\"题目大意\"></a>题目大意</h2><p>有$n$种零件，每种零件的加工时间最少为3天最多为9天，给出$m$个工程用的时间和加工的零件数，求每种零件的加工时间。</p>\n<h2 id=\"解析\"><a href=\"#解析\" class=\"headerlink\" title=\"解析\"></a>解析</h2><p>列出$m$个方程，用高斯消元求解。</p>\n<p>需要判断无解和多解。</p>\n<h2 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h2><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstdio&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cstring&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;cmath&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> db double</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> <span class=\"built_in\">std</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N=<span class=\"number\">310</span>,mod=<span class=\"number\">7</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n,m,inv[<span class=\"number\">10</span>];</span><br><span class=\"line\"><span class=\"keyword\">int</span> mat[N][N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">int</span> <span class=\"title\">getday</span><span class=\"params\">(<span class=\"keyword\">char</span> *s)</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(s[<span class=\"number\">0</span>]==<span class=\"string\">'M'</span>) <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(s[<span class=\"number\">0</span>]==<span class=\"string\">'T'</span>) <span class=\"keyword\">return</span> s[<span class=\"number\">1</span>]==<span class=\"string\">'U'</span>?<span class=\"number\">2</span>:<span class=\"number\">4</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(s[<span class=\"number\">0</span>]==<span class=\"string\">'W'</span>) <span class=\"keyword\">return</span> <span class=\"number\">3</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(s[<span class=\"number\">0</span>]==<span class=\"string\">'F'</span>) <span class=\"keyword\">return</span> <span class=\"number\">5</span>;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(s[<span class=\"number\">0</span>]==<span class=\"string\">'S'</span>) <span class=\"keyword\">return</span> s[<span class=\"number\">1</span>]==<span class=\"string\">'A'</span>?<span class=\"number\">6</span>:<span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">int</span> <span class=\"title\">gauss</span><span class=\"params\">()</span></span>&#123; <span class=\"comment\">//无解返回0，多解返回-1，唯一解返回1 </span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> now=<span class=\"number\">1</span>,nxt;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)&#123;</span><br><span class=\"line\">        nxt=<span class=\"number\">-1</span>; </span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j=now;j&lt;=m;j++) <span class=\"keyword\">if</span>(mat[j][i])&#123;nxt=j;<span class=\"keyword\">break</span>;&#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(nxt==<span class=\"number\">-1</span>) <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(nxt!=now) <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j=i;j&lt;=n+<span class=\"number\">1</span>;j++) swap(mat[now][j],mat[nxt][j]);</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j=now+<span class=\"number\">1</span>;j&lt;=m;j++)&#123;</span><br><span class=\"line\">            <span class=\"keyword\">int</span> temp=mat[j][i]*inv[mat[now][i]]%mod;</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> k=i;k&lt;=n+<span class=\"number\">1</span>;k++) mat[j][k]=((mat[j][k]-temp*mat[now][k])%mod+mod)%mod;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        now++;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;i++)<span class=\"keyword\">if</span>(mat[i][n+<span class=\"number\">1</span>])&#123;</span><br><span class=\"line\">        <span class=\"keyword\">bool</span> flag=<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j=<span class=\"number\">1</span>;j&lt;=n;j++) <span class=\"keyword\">if</span>(mat[i][j])&#123;flag=<span class=\"number\">0</span>;<span class=\"keyword\">break</span>;&#125;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(flag) <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(now&lt;=n) <span class=\"keyword\">return</span> <span class=\"number\">-1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=n;i&gt;=<span class=\"number\">1</span>;i--)&#123;</span><br><span class=\"line\">        mat[i][n+<span class=\"number\">1</span>]=mat[i][n+<span class=\"number\">1</span>]*inv[mat[i][i]]%mod;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j=<span class=\"number\">1</span>;j&lt;=i<span class=\"number\">-1</span>;j++) mat[j][n+<span class=\"number\">1</span>]=((mat[j][n+<span class=\"number\">1</span>]-mat[j][i]*mat[i][n+<span class=\"number\">1</span>])%mod+mod)%mod;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(mat[i][n+<span class=\"number\">1</span>]&lt;<span class=\"number\">3</span>) mat[i][n+<span class=\"number\">1</span>]+=mod;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!n) <span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">    <span class=\"keyword\">int</span> t1,k;</span><br><span class=\"line\">    <span class=\"keyword\">char</span> s1[<span class=\"number\">10</span>],s2[<span class=\"number\">10</span>];</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;i++)&#123;</span><br><span class=\"line\">        <span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d%s%s\"</span>,&amp;k,s1,s2);</span><br><span class=\"line\">        mat[i][n+<span class=\"number\">1</span>]=(getday(s2)-getday(s1)+<span class=\"number\">8</span>)%<span class=\"number\">7</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j=<span class=\"number\">1</span>;j&lt;=k;j++) <span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;t1),mat[i][t1]+=<span class=\"number\">1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j=<span class=\"number\">1</span>;j&lt;=n;j++) mat[i][j]%=mod;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> x=gauss();</span><br><span class=\"line\">    <span class=\"keyword\">if</span>(!x) <span class=\"built_in\">printf</span>(<span class=\"string\">\"Inconsistent data.\\n\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(x==<span class=\"number\">-1</span>) <span class=\"built_in\">printf</span>(<span class=\"string\">\"Multiple solutions.\\n\"</span>);</span><br><span class=\"line\">    <span class=\"keyword\">else</span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;n;i++) <span class=\"built_in\">printf</span>(<span class=\"string\">\"%d \"</span>,mat[i][n+<span class=\"number\">1</span>]);</span><br><span class=\"line\">        <span class=\"built_in\">printf</span>(<span class=\"string\">\"%d\\n\"</span>,mat[n][n+<span class=\"number\">1</span>]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(mat,<span class=\"number\">0</span>,<span class=\"keyword\">sizeof</span>(mat));</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;<span class=\"number\">7</span>;i++) inv[i]=<span class=\"keyword\">int</span>(<span class=\"built_in\">pow</span>(<span class=\"number\">1.0</span>*i,<span class=\"number\">5</span>))%<span class=\"number\">7</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d%d\"</span>,&amp;n,&amp;m)) solve();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","prev":{"title":"「BZOJ4031」[HEOI2015]小Z的房间","slug":"「BZOJ4031」-HEOI2015-小Z的房间"},"next":{"title":"「POJ2942」Knights of the Round Table","slug":"「POJ2942」Knights of the Round Table"},"link":"/2018/03/08","toc":[{"title":"题目大意","id":"题目大意","index":"1"},{"title":"解析","id":"解析","index":"2"},{"title":"代码","id":"代码","index":"3"}]}