{"title":"「luogu2714」四元组统计","date":"2018-03-08T05:19:13.000Z","excerpt":"","slug":"「luogu2714」四元组统计","updated":"2018-07-15T15:23:56.165Z","content":"<h2 id=\"题目大意\"><a href=\"#题目大意\" class=\"headerlink\" title=\"题目大意\"></a>题目大意</h2><p>有$n$个正整数$a_i$，统计有多少个四元组满足$gcd(a_i,a_j,a_k,a_l)$=1。</p>\n<h2 id=\"解析\"><a href=\"#解析\" class=\"headerlink\" title=\"解析\"></a>解析</h2><p>令$f[i]$为$gcd(a_i,a_j,a_k,a_l)$为$i$的倍数的四元组个数，$g[i]$为$gcd(a_i,a_j,a_k,a_l)$为$i$的四元组个数。</p>\n<p>$f[i]$比较好求，令$X$为$a_i$中i的倍数的个数，则:</p>\n<script type=\"math/tex; mode=display\">f[i]=C_{X}^{4}</script><p>接下来用$f[i]$求出$g[i]$:</p>\n<script type=\"math/tex; mode=display\">f[i]=\\sum_{i|j}^{} {g[j]}</script><p>莫比乌斯反演一下</p>\n<script type=\"math/tex; mode=display\">g[i]=\\sum_{i|j}^{} {\\mu[\\frac{j}{i}]} f[j]</script><p>完成！</p>\n<h2 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h2><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> ll long long</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> <span class=\"built_in\">std</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N=<span class=\"number\">10010</span>,maxn=<span class=\"number\">10000</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n,a[N],u[N],p[N],totp;</span><br><span class=\"line\">ll f[N];</span><br><span class=\"line\"><span class=\"keyword\">bool</span> isp[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> ll <span class=\"title\">calc</span><span class=\"params\">(ll k)</span></span>&#123;<span class=\"keyword\">return</span> k*(k<span class=\"number\">-1</span>)*(k<span class=\"number\">-2</span>)*(k<span class=\"number\">-3</span>)/<span class=\"number\">4</span>/<span class=\"number\">3</span>/<span class=\"number\">2</span>;&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">solve</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(a,<span class=\"number\">0</span>,<span class=\"keyword\">sizeof</span>(a));</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(f,<span class=\"number\">0</span>,<span class=\"keyword\">sizeof</span>(f));</span><br><span class=\"line\">    <span class=\"keyword\">int</span> t;</span><br><span class=\"line\">    ll ans=<span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++) <span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;t),a[t]++;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=maxn;i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j=i;j&lt;=maxn;j+=i) f[i]+=a[j];</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(f[i]&gt;<span class=\"number\">3</span>) f[i]=calc(f[i]);</span><br><span class=\"line\">        <span class=\"keyword\">else</span> f[i]=<span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=maxn;i++) ans+=f[i]*u[i];</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"%lld\\n\"</span>,ans);</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    isp[<span class=\"number\">1</span>]=<span class=\"number\">1</span>,u[<span class=\"number\">1</span>]=<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i=<span class=\"number\">2</span>;i&lt;=maxn;i++)&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span>(!isp[i]) p[++totp]=i,u[i]=<span class=\"number\">-1</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> j=<span class=\"number\">1</span>;j&lt;=totp&amp;&amp;p[j]*i&lt;=maxn;j++)&#123;</span><br><span class=\"line\">            isp[p[j]*i]=<span class=\"number\">1</span>;</span><br><span class=\"line\">            <span class=\"keyword\">if</span>(!(i%p[j])) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            u[p[j]*i]=-u[i];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(<span class=\"built_in\">scanf</span>(<span class=\"string\">\"%d\"</span>,&amp;n)!=EOF) solve();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","prev":{"title":"「BZOJ1070」[SCOI2007]修车","slug":"「BZOJ1070」-SCOI2007-修车"},"next":{"title":"「luogu1251」餐巾计划问题","slug":"「luogu1251」餐巾计划问题"},"link":"/2018/03/08","toc":[{"title":"题目大意","id":"题目大意","index":"1"},{"title":"解析","id":"解析","index":"2"},{"title":"代码","id":"代码","index":"3"}]}