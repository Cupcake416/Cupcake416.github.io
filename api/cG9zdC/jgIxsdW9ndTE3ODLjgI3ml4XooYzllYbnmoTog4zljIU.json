{"title":"「luogu1782」旅行商的背包","date":"2018-03-09T11:44:06.000Z","excerpt":"","slug":"「luogu1782」旅行商的背包","updated":"2018-07-19T15:25:04.253Z","content":"<h2 id=\"题目大意\"><a href=\"#题目大意\" class=\"headerlink\" title=\"题目大意\"></a>题目大意</h2><p>小S坚信任何问题都可以在多项式时间内解决，于是他准备亲自去当一回旅行商。在出发之前，他购进了一些物品。这些物品共有$n$种，第$i$种体积为$V_i$，价值为$W_i$，共有$D_i$件。他的背包体积是$C$。怎样装才能获得尽量多的收益呢？作为一名大神犇，他轻而易举的解决了这个问题。</p>\n<p>然而，就在他出发前，他又收到了一批奇货。这些货共有$m$件，第$i$件的价值$Y_i$与分配的体积$X_i$之间的关系为:$Y_i=a_i <em> X_i^{2} + b_i </em> X_i+c_i$。这是件好事，但小S却不知道怎么处理了，于是他找到了一位超级神犇（也就是你），请你帮他解决这个问题。</p>\n<h2 id=\"解析\"><a href=\"#解析\" class=\"headerlink\" title=\"解析\"></a>解析</h2><p>普通物品部分是一个多重背包，令f[i][j]表示前$i$件物品，用容量$j$获得的最大价值，列出dp方程：</p>\n<script type=\"math/tex; mode=display\">f[i][j]=\\max{f[i-1][j-k*V_i]+k*W_i}</script><p>时间复杂度$O(N^2C)$,无法满足题目要求，考虑单调队列优化。</p>\n<p>经过观察，我们发现转移只发生在$j$在模$V_i$意义下相同的状态之间，所以把状态按照$j$模$V_i$的值分组，令$x=j%V_i$,dp方程可以改写成这样：</p>\n<script type=\"math/tex; mode=display\">f[i][j]=\\max_{k\\leq \\frac{j-x}{V_i}}{f[i-1][k*V_i+x]+(\\frac{j-x}{V_i}-k)*W_i}</script><p>把$k*W_i$提出来</p>\n<script type=\"math/tex; mode=display\">f[i][j]=\\max_{k\\leq \\frac{j-x}{V_i}}{f[i-1][k*V_i+x]+\\frac{j-x}{V_i}*W_i}+k*W_i</script><p>max里的部分可以用单调队列优化。</p>\n<p>因为这题$m$很小，第二部分直接用朴素方法就可以了。</p>\n<h2 id=\"代码\"><a href=\"#代码\" class=\"headerlink\" title=\"代码\"></a>代码</h2><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span><span class=\"meta-string\">&lt;bits/stdc++.h&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> ll long long</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> R register</span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> <span class=\"built_in\">std</span>;</span><br><span class=\"line\"><span class=\"keyword\">const</span> <span class=\"keyword\">int</span> N=<span class=\"number\">20010</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> n,m,cap,v[N],w[N],d[N],a[N],b[N],c[N],ans=<span class=\"number\">0</span>,cnt[N];</span><br><span class=\"line\">ll f[N],q[N];</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">inline</span> <span class=\"keyword\">int</span> <span class=\"title\">read</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> x=<span class=\"number\">0</span>,w=<span class=\"number\">1</span>;<span class=\"keyword\">char</span> c=<span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c&lt;<span class=\"string\">'0'</span>||c&gt;<span class=\"string\">'9'</span>)&#123;<span class=\"keyword\">if</span>(c==<span class=\"string\">'-'</span>) w=<span class=\"number\">-1</span>;c=getchar();&#125;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(c&gt;=<span class=\"string\">'0'</span>&amp;&amp;c&lt;=<span class=\"string\">'9'</span>) x=(x&lt;&lt;<span class=\"number\">3</span>)+(x&lt;&lt;<span class=\"number\">1</span>)+c-<span class=\"string\">'0'</span>,c=getchar();</span><br><span class=\"line\">    <span class=\"keyword\">return</span> x*w;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">()</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> t,h,nxt;</span><br><span class=\"line\">    n=read(),m=read(),cap=read();</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(R <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++) v[i]=read(),w[i]=read(),d[i]=read();</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(R <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;i++) a[i]=read(),b[i]=read(),c[i]=read();</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(R <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=n;i++)</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(R <span class=\"keyword\">int</span> j=<span class=\"number\">0</span>;j&lt;v[i];j++)</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(R <span class=\"keyword\">int</span> k=<span class=\"number\">0</span>,head=<span class=\"number\">0</span>,tail=<span class=\"number\">0</span>;k*v[i]+j&lt;=cap;k++)&#123;</span><br><span class=\"line\">                <span class=\"keyword\">int</span> nxt=f[k*v[i]+j]-k*w[i];</span><br><span class=\"line\">                <span class=\"keyword\">if</span>(k-cnt[head]&gt;d[i]) head++;</span><br><span class=\"line\">                <span class=\"keyword\">while</span>(head&lt;tail&amp;&amp;q[tail<span class=\"number\">-1</span>]&lt;nxt) tail--;</span><br><span class=\"line\">                q[tail]=nxt,cnt[tail++]=k;</span><br><span class=\"line\">                f[k*v[i]+j]=q[head]+k*w[i];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">    <span class=\"keyword\">for</span>(R <span class=\"keyword\">int</span> i=<span class=\"number\">1</span>;i&lt;=m;i++)</span><br><span class=\"line\">        <span class=\"keyword\">for</span>(R <span class=\"keyword\">int</span> j=cap;j&gt;=<span class=\"number\">0</span>;j--)</span><br><span class=\"line\">            <span class=\"keyword\">for</span>(R <span class=\"keyword\">int</span> k=<span class=\"number\">0</span>;k&lt;=j;k++) f[j]=max(f[j],f[j-k]+a[i]*k*k+b[i]*k+c[i]);</span><br><span class=\"line\">    <span class=\"built_in\">printf</span>(<span class=\"string\">\"%lld\"</span>,f[cap]);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","prev":{"title":"「UOJ34」多项式乘法","slug":"「UOJ34」多项式乘法"},"next":{"title":"「luogu2596」[ZJOI2006]书架","slug":"「luogu2596」[ZJOI2006]书架"},"link":"/2018/03/09","toc":[{"title":"题目大意","id":"题目大意","index":"1"},{"title":"解析","id":"解析","index":"2"},{"title":"代码","id":"代码","index":"3"}]}